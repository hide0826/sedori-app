[![Latest release](https://img.shields.io/github/v/release/hide0826/sedori-app?display_name=tag&sort=semver)](https://github.com/hide0826/sedori-app/releases)
[![CI](https://img.shields.io/github/actions/workflow/status/hide0826/sedori-app/progress-update.yml?label=CI)](https://github.com/hide0826/sedori-app/actions)

# せどり事業自動化アプリ (HIRIO) — v0.3.3
# sedori-app

# せどりアプリ Python実装仕様書（改良版）

## 🎯 概要

中古店舗せどりの事務業務を完全自動化するPythonアプリケーション。Excel依存を脱却し、データ整合性・処理速度・拡張性を大幅改善。

---

## 📋 基本機能（Excel移植＋改良版）

### 1. 仕入リスト取り込み機能

**改良点：JAN コード破損問題を完全解決**

**Input:** アマサーチ仕入リスト（CSV）

```
仕入れ日, コンディション, ASIN, JAN, 商品名, 仕入れ個数, 仕入れ価格, 販売予定価格, 見込み利益, 損益分岐点, コメント, 参考価格, 発送方法, 仕入れ先, コンディション説明, SKU, その他費用

```

**処理内容：**

- ✅ **JAN コード型指定読み込み**（`dtype={'JAN': str}`で文字列強制）
- ✅ **重複チェック**（ASIN+コンディション+仕入れ先の組み合わせ）
- ✅ **データ検証**（必須項目チェック、価格妥当性検証）
- ✅ **自動バックアップ**（処理前データ保存）

**Output:** 検証済み仕入データ（内部DB保存）

---

### 2. Qタグ自動判定機能

**改良点：キーワード辞書の動的管理**

**処理ロジック：**

```python
Q_KEYWORDS = {
    'Q1': ['加湿器', 'ヒーター', 'こたつ', 'ストーブ', '暖房'],
    'Q2': ['花粉', '新生活', '入学', '卒業'],
    'Q3': ['扇風機', 'サーキュレーター', '冷風', 'アウトドア', 'プール', '水遊び'],
    'Q4': ['おもちゃ', 'レゴ', 'トミカ', 'プラレール', 'クリスマス', 'お歳暮']
}

```

**改良点：**

- ✅ **API連携優先**（Keepa/Amazon APIでカテゴリ取得→キーワードはフォールバック）
- ✅ **学習機能**（売上データから季節パターンを自動学習）
- ✅ **設定ファイル**（keywords.yaml で簡単編集）

---

### 3. SKU生成機能

**改良点：重複防止＋履歴管理**

**SKU形式：** `YYMMDD-状態番号-連番[-Qタグ]`

**状態番号対応表：**

| コンディション | 番号 |
| --- | --- |
| 新品 | 11 |
| 中古（ほぼ新品） | 1 |
| 中古（非常に良い） | 2 |
| 中古（良い） | 3 |
| 中古（可） | 4 |

**改良点：**

- ✅ **重複チェック**（既存SKU確認後、連番自動採番）
- ✅ **バッチ処理対応**（複数商品一括SKU生成）
- ✅ **履歴管理**（SKU生成ログ保存）

---

### 4. 検品リスト生成機能

**改良点：作業効率向上**

**Output形式：**

```
コンディション, JAN, 商品名, 仕入れ個数, 店舗名, コメント, SKU, 検品ステータス

```

**改良点：**

- ✅ **QRコード生成**（JAN→QRコード変換で読み取り効率化）
- ✅ **進捗管理**（検品完了チェック機能）
- ✅ **写真連携**（商品写真フォルダ自動作成）

---

### 5. 出品用CSV生成機能

**改良点：プライスター完全対応**

**Output:** プライスターかんたんCSV

- ✅ **テンプレート管理**（プライスター仕様変更に柔軟対応）
- ✅ **価格戦略適用**（利益率・競合価格考慮）
- ✅ **一括・個別選択**（部分出品対応）

---

### 6. 外注用リスト生成機能

**改良点：リアルタイム連携**

**Input:** Amazonピッキングリスト + SKU入りリスト
**改良点：**

- ✅ **DB直接参照**（SKU入りリスト依存から脱却）
- ✅ **進捗追跡**（外注作業ステータス管理）
- ✅ **品質チェック**（外注完了品の自動検証）

---

### 7. 商品DB生成機能

**改良点：リレーショナルDB設計**

**DBテーブル設計：**

```sql
-- 商品マスタ
products (id, asin, jan, name, category, created_at)

-- 仕入れ履歴
purchases (id, product_id, condition, price, date, store_id, sku)

-- 売上履歴
sales (id, product_id, sale_price, sale_date, profit, fees)

-- 店舗マスタ
stores (id, name, category, address, notes)

```

**改良点：**

- ✅ **正規化設計**（データ重複排除）
- ✅ **インデックス最適化**（高速検索）
- ✅ **バックアップ自動化**（日次バックアップ）

---

### 8. 古物台帳生成機能

**改良点：税務対応強化**

**Output:**

- 古物台帳（法的要件対応）
- 確定申告補助資料（収支内訳書形式）

**改良点：**

- ✅ **税務署フォーマット準拠**
- ✅ **期間指定出力**（月次・年次）
- ✅ **PDF自動生成**（印刷・提出用）

---

## 🔧 新規追加機能

### 9. データ整合性管理

- **重複統合ウィザード**（同一商品の複数仕入れ統合）
- **データ修復機能**（JAN コード自動補完）
- **整合性チェック**（在庫・売上データ照合）

### 10. 自動価格調整

- **競合価格監視**（定期的な価格チェック）
- **利益率維持ルール**（最低利益率設定）
- **季節調整**（Qタグ連動価格戦略）

### 11. 分析ダッシュボード

- **店舗別ROI分析**
- **商品回転率分析**
- **季節トレンド分析**

---

## ⚠️ 要相談事項

### A. 技術選択

**1. データベース選択**

- SQLite（ローカル、シンプル）vs PostgreSQL（スケーラブル）
- 想定データ量：月間仕入れ件数×12ヶ月×保存年数

**2. GUI フレームワーク**

- Tkinter（標準、軽量）vs PyQt（高機能）vs Web UI（Flask/Django）
- モバイル対応の必要性

**3. 外部API連携**

- Keepa API（有料）vs 代替手段
- Amazon API（審査必要）vs スクレイピング（規約リスク）

### B. 運用設計

**1. 設定管理**

- 店舗マスタの管理方法（GUI編集 vs ファイル編集）
- 価格改定ルールの柔軟性レベル
- Qタグキーワードの学習頻度

**2. データ移行**

- 既存Excelデータの移行戦略
- 移行時のデータ検証方法
- ロールバック対応

**3. 配布・更新**

- 実行ファイル化（PyInstaller）vs Python環境必須
- 自動更新機能の必要性
- 設定ファイルの互換性維持

### C. 拡張性

**1. マルチユーザー対応**

- 将来的な複数人での使用想定
- データ共有・権限管理の必要性

**2. クラウド連携**

- Google Sheets連携の必要性
- Looker Studio自動更新
- バックアップのクラウド保存

**3. 外注管理**

- 外注先との情報共有方法
- 進捗管理の詳細レベル
- 品質管理基準の設定

---

## 📊 実装優先順位

### Phase 1: 基盤構築（2-3週間）

1. データ型安全なCSV読み込み（JAN コード問題解決）
2. 基本的なSKU生成
3. SQLiteベースのDB構築
4. 既存データ移行ツール

### Phase 2: 基本機能移植（3-4週間）

1. 全8機能のPython移植
2. GUI基本画面
3. データ検証機能
4. 基本的なエラーハンドリング

### Phase 3: 改良・自動化（4-5週間）

1. 重複チェック・統合機能
2. 価格監視・調整機能
3. 分析レポート機能
4. 外部API連携

### Phase 4: 高度機能（継続開発）

1. AI予測機能
2. ダッシュボード完成
3. モバイル対応
4. クラウド連携

---

## 💭 検討が必要な課題

1. **データ量の想定**: 月間何件の仕入れを想定するか？
2. **使用環境**: Windows専用 vs クロスプラットフォーム
3. **ネットワーク依存**: オフライン作業の必要性
4. **セキュリティ**: 売上データの暗号化必要性
5. **法的要件**: 古物営業法の詳細要件確認
6. **運用体制**: 開発後のメンテナンス・サポート体制

---

この仕様書をベースに、具体的な技術選択と実装計画を決定していきましょう。どの部分から優先的に検討したいですか？
